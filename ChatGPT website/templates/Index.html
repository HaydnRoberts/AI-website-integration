<!DOCTYPE html>
<html>
<head>
    <title>JCareer Coach Brad</title>
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
    <h1>Career Coach Brad</h1>

    <div id="chat_history" class="chat-container" type="text"></div>

    <div class="text-bar">
        <form id="RunPython">
            <div class="input-container">
                <textarea id="prompt" name="prompt" placeholder="What would you like to ask..."></textarea>
                <button type="submit" id="runButton">âžœ</button>
            </div>
        </form>
        <div class="option-bar">
            <label for="options" style="color:white;">How many previous questions Carrer coach will remember:</label>
            <select id="options">
                <option value="3">3</option>
                <option value="2">2</option>
                <option value="1">1</option>
                <option value="0">0</option>
            </select>
            <button id="refreshButton">Refresh chat history</button>
        </div>
    </div>
    
    <script>
        document.getElementById("RunPython").addEventListener("submit", function(event) {
            event.preventDefault();
            runCode();
        });


        function runCode() {
            // Get the user's input from the "prompt" input field
            const userPrompt = document.getElementById("prompt").value;
            const selectBox = document.getElementById("options");
    
            // Get the selected chat memory value
            const chatMemory = selectBox.value;
    
            // Send the user's input to the server (Python) along with the POST request
            fetch("/AI_test.py", {
                method: "POST",
                body: JSON.stringify({ 
                    prompt: userPrompt,
                    chat_memory: chatMemory, // Include the selected chat memory value
                }),
                headers: {
                    "Content-Type": "application/json",
                },
            })
                .then(chat_history => chat_history.json())
                .then(data => {
                    document.getElementById("chat_history").innerText = data.chat_history;
                })
                .catch(error => {
                    console.error("Error:", error);
                });
        };
    
        document.getElementById("refreshButton").addEventListener("click", function() {
            // Get the selected chat memory value
            const selectBox = document.getElementById("options");
            const chatMemory = selectBox.value;
    
            // Send a separate request to refresh chat history using a different endpoint
            fetch("/refresh_chat_history", {
                method: "POST",
                body: JSON.stringify({ chat_memory: chatMemory }),
                headers: {
                    "Content-Type": "application/json",
                },
            })
                .then(chat_history => chat_history.json())
                .then(data => {
                    document.getElementById("chat_history").innerText = data.chat_history;
                })
                .catch(error => {
                    console.error("Error:", error);
                });
        });
    </script>
</body>
</html>